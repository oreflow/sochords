<div class="edit-song-root">
  <div class="loading" *ngIf="state === states.LOADING"><mat-spinner color="accent"></mat-spinner></div>
  <div class="error" *ngIf="state === states.ERROR"><sc-error [errorType]="error"></sc-error></div>
  <div *ngIf="state === states.RUNNING">
    <div class="basic-info">
      <div class="header-row">
        <h1>Basic Info</h1>
        <button mat-icon-button 
                color="accent" 
                (click)="updateSong()"
                [routerLink]="['/song', song.id]"
                matTooltip="Done Editing" ><mat-icon>check</mat-icon></button>
      </div>
      <div class="basic-info-form">
        <div class="song-title-wrapper">
          <h2>Title</h2>
          <mat-form-field class="song-title-field">
            <input matInput 
                   [(ngModel)]="song?.info.title" 
                   (change)="updateSong()"/>
          </mat-form-field>
        </div>
        <div class="artists-wrapper">
          <h2>Artists</h2>
          <div class="artist-row" *ngFor="let artist of song?.info.artists; let i = index;">
            <mat-form-field class="artist-name-field">
              <input matInput 
                     [(ngModel)]="artist.name" 
                     (change)="updateSong()"/>
            </mat-form-field>
            <button mat-icon-button 
                    color="accent" 
                    *ngIf="i > 0" 
                    (click)="removeArtist(artist)"><mat-icon>close</mat-icon></button>
          </div>
          <button mat-stroked-button color="accent" (click)="addArtist()">ADD ARTIST</button>
        </div>
      </div>
      <div>
      </div>
    </div>
    <mat-divider></mat-divider>
    <div class="section-info">
      <h1>Instructions</h1>
      <div class="song-sections">
        <div class="section" *ngFor="let section of song?.sections" [ngSwitch]="section.sectionType">
          <div class="section-info">
            <mat-form-field class="section-name-field">
              <mat-label>Section name</mat-label>
              <input matInput 
                     class="section-name-field"
                     [(ngModel)]="section.info.name" 
                     (change)="updateSectionInfo(section.id, section.info)"/>
            </mat-form-field>
            <button mat-icon-button class="remove-section-button" (click)="removeSection(section)" color="warn">
              <mat-icon>close</mat-icon>
            </button>
          </div>
          <div *ngSwitchCase="sectionTypeEnum.TAB_SECTION" >
            <tab-section [editing]="true"
                         [tabSection]="section.tabSection"
                         (updated)="updateTabSection(section.id, $event)"></tab-section>
          </div>
          <div *ngSwitchCase="sectionTypeEnum.CHORD_SECTION">
            <chord-section [editing]="true"
                           [chordSection]="section.chordSection"
                           (updated)="updateChordSection(section.id, $event)"></chord-section>
          </div>
          <div *ngSwitchDefault>Unidentified type</div>
        </div>
        <button 
           class="add-song-section-button" 
           mat-stroked-button
           color="accent"
           [matMenuTriggerFor]="sectionTypeMenu">
          <mat-icon>add</mat-icon>ADD SECTION
        </button>
        <mat-menu #sectionTypeMenu="matMenu">
          <button mat-menu-item (click)="addSection(sectionTypeEnum.TAB_SECTION)">Tab Section</button>
          <button mat-menu-item (click)="addSection(sectionTypeEnum.CHORD_SECTION)">Chords Section</button>
        </mat-menu>
      </div>
      <div>
    </div>
  </div>
</div>
